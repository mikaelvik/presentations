<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Hackaton#2 - WiX</title>
  <meta name="description" content="TestDemo">
  <meta name="author" content="Mikael Vik">
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="../../reveal/css/reveal.css">
  <link rel="stylesheet" href="../../reveal/css/theme/solarized.css" id="theme">
  <link rel="stylesheet" href="../css/invopres.css">

  <!-- For syntax highlighting -->
  <link rel="stylesheet" href="../../reveal/lib/css/zenburn.css">

  <!-- If the query includes 'print-pdf', use the PDF print sheet -->
  <script>
    document.write(
      '<link rel="stylesheet" href="../../reveal/css/print/' 
      + (window.location.search.match(/print-pdf/gi) ? 'pdf' : 'paper')
      + '.css" type="text/css" media="print">');
  </script>

  <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
  <![endif]-->
</head>

<body>

<div class="reveal">
<div class="slides">

  <section>
    <h3>Hackaton #2</h3>
    <h1>WiX</h1>
    <p class=small>
      <a href="http://github.com/mikaelvik">Mikael Vik</a> / mikael.vik@gmail.com
    </p>
  </section>

  <section data-markdown>
    ## Agenda
    * WiX
        * Intro
        * Windows Installer
        * MSI
        * Exe
        * MSBuild+TeamCity
  </section>

  <section>
    <section data-markdown>
      <script type="text/template">
        ## WiX 
        
        * Windows Installer XML
        * Første Open Source-prosjekt frå Microsoft hosta eksternt
        * Deklarativ spesifikasjon
        * Full MSBuild-støtte
                
      </script>
    </section>

    <section data-markdown>
      ### Product

      * Features
      * Componenents
      * Custom Actions
      * Fragments

      * Verdt å nevne
          * haugevis av guids (installerte plugin, Ctrl+I,)

    </section>

    <section data-markdown>
      ### Bundle

    </section>
  </section>

  <section>
    <section data-markdown>
      <script type="text/template">
        ### Toolset
          
        * Candle - compile
        * Light - link
        * Heat - harvest
        * Dark - reverse engineer
        * Burn - bootstrap
      </script>
    </section>
    
  </section>

  <section data-markdown contenteditable=contenteditable>
    <script type="text/template">
      ### Burn - bootstrapper
      
      * Exe-fil med bundla msi-pakkar
      * Installasjon av fleire pakkar
      * Prerequisites
          * .NET (vha extension)
          * VSTOR (vha registry search og remote payload)
    </script>
  </section>

  <section data-markdown contenteditable=contenteditable>
    <script type="text/template">
      ### Dark - reverse engineering
      
      * Lag wxs for eksisterende msi
      * God på:
          * filer
          * registry
      * Dårlig på:
          * custom actions
    </script>
  </section>

  <section data-markdown>
    <script type="text/template">
      ### Heat - harvesting
      
      * Automatisk opprett wxs components for filer
      * Særs nyttig for remote payloads
      
      ```bash
      > heat payload vstor_redis.exe -out remote.xml
      ```

      ```xml 
      <RemotePayload 
           ProductName="Microsoft Visual Studio Tools for Office Runtime 2010 Redistributable"
           Description="Microsoft Visual Studio Tools for Office Runtime 2010 Redistributable Setup"
           Version="10.0.60724.0"
           Size="40102072"
           CertificatePublicKey="52868DFCA6E3AF2632389E6C1EE7D0468D3797D0"
           CertificateThumbprint="3BDA323E552DB1FDE5F4FBEE75D6D5B2B187EEDC"
           Hash="F6022EB966DF7AF80F6DF5DB0D00A0B7A8F516B3" />
      ```
    </script>
  </section>

  <section data-markdown>
    ### Preprocessor

    * [Dokumentasjon](http://wixtoolset.org/documentation/manual/v3/overview/preprocessor.html)
    * Bygg ulike installere 
    * Filtrér hvilke deler av som tas med i bygget
        * conditionals (if, ifdef, ifndef, elseif, else, endif)
        * foreach

  </section>



  <!-- Bygge-demo -->
  <section data-background="#8F7700" data-transition="zoom" data-transition-speed="slow">
    <h1 style="color: black; font-size: 9em;">Demo</h1>
    <p style="color: black">Testing i VS</p>
  </section>

  <section>
    <section data-transition="fade">
      <h2>TeamCity-oppsett</h2>
      <ul>
        <li>Automatisk bygge artefakter</li>
        <li>Sette versjon</li>
        <li class="fragment roll-in">Tilgjengeligjøres enkelt</li>
      </ul>
    </section>
  </section>

  <section>
    <section data-markdown contenteditable=contenteditable>
      <script type="text/template">
        ## Andre muligheter med WiX
        
        * Installere Windows Service
        * Installere web-app i IIS
        * Ganske enkelt plassere filer på ei maskin...
        * +++
      </script>
    </section>
  </section>

  <section data-markdown data-background="#E1C5EB" data-background-transition="zoom">
    ### Gjenstår

    * Upgrade
        * fikse slik at installasjon fungerer ved ny versjon
        * hvordan skal versjonsnummer inkrementeres
        * major, minor, revision, buildnumber?
    * Settings-dialog
        * Online, OnPremise, Custom
        * gir ulike valg for configpath
    * Lisensiering
        * dialog for å angi
        * verifisering
        * lagre i registry (behold ved uninstall?)
  </section>

  <section data-background="#EE9732" data-transition="zoom" data-transition-speed="slow">
    <h1 style="color: black;">Spørsmål?</h1>
    <img height="350" src="../assets/hjallis_cooper.jpg" alt="">
  </section>

  <section data-background="#B8E0DE" data-transition="fade" data-transition-speed="slow">
    <h2>Neste Hackaton</h2>

    <ul>
      <li>Dependency Injection
        <ul>
          <li>
            <a href="https://github.com/ninject/ninject">Ninject</a>
          </li>
          <li>evt andre alternativ</li>
        </ul>
      </li>
      <li>Git vs TFVC</li>
    </ul>
  </section>

</div>
</div>

<script src="../../reveal/lib/js/head.min.js"></script>
<script src="../../reveal/js/reveal.min.js"></script>

<script>

  // Full list of configuration options available here:
  // https://github.com/hakimel/reveal.js#configuration
  Reveal.initialize({
    controls: true,
    progress: true,
    history: true,
    center: true,

    theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
    transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

    // Optional libraries used to extend on reveal.js
    dependencies: [
      {
        src: '../../reveal/lib/js/classList.js',
        condition: function() {
          return !document.body.classList;
        }
      },
      {
        src: '../../reveal/plugin/markdown/marked.js',
        condition: function() {
          return !!document.querySelector('[data-markdown]');
        }
      },
      {
        src: '../../reveal/plugin/markdown/markdown.js',
        condition: function() {
          return !!document.querySelector('[data-markdown]');
        }
      },
      {
        src: '../../reveal/plugin/highlight/highlight.js',
        async: true,
        callback: function() {
          hljs.initHighlightingOnLoad();
        }
      },
      {
        src: '../../reveal/plugin/zoom-js/zoom.js',
        async: true,
        condition: function() {
          return !!document.body.classList;
        }
      },
      {
        src: '../../reveal/plugin/notes/notes.js',
        async: true,
        condition: function() {
          return !!document.body.classList;
        }
      }
    ]
  });

</script>

</body>
</html>